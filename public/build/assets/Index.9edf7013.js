import{g as S,r as c,o as _,e as A,w as s,W as N,a as t,b as a,U as n,ag as j,c as k,S as d,K as v,L as w,Q as D,a4 as P,X as R,Y as I,I as i}from"./app.c248d67c.js";import{_ as z,r as F}from"./AppLayout.4269b78a.js";import{r as U,B as q}from"./Table.94a0e2ae.js";import{B as L}from"./SearchInput.2608ef07.js";import{u as O}from"./search.181f2eee.js";import"./Logo.d971df1b.js";import"./wizardStore.2226bc2a.js";import"./menu.6da08311.js";import"./ChevronDownIcon.f3847a45.js";import"./CheckIcon.5f685430.js";import"./XIcon.0ce515ba.js";import"./PencilIcon.50f1eb3f.js";import"./RefreshIcon.6547917e.js";const $={class:"flex justify-between mb-4"},Q={class:"w-1/2"},E={class:"grow flex justify-end gap-x-3 mr-3"},K={key:0,class:"inline-flex items-center rounded-full bg-yellow-100 px-6 py-2.5 text-sm font-medium text-yellow-800"},W=["href"],X=t("svg",{width:"20",height:"21",viewBox:"0 0 20 21",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M10 5C14.9706 5 19 4.10457 19 3C19 1.89543 14.9706 1 10 1C5.02944 1 1 1.89543 1 3C1 4.10457 5.02944 5 10 5Z","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),t("path",{d:"M1 3C1 5.23 4.871 9.674 6.856 11.805C7.58416 12.5769 7.99291 13.5959 8 14.657V20L12 18V14.657C12 13.596 12.421 12.582 13.144 11.805C15.13 9.674 19 5.231 19 3","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),Y=[X],Z=t("h3",{class:"text-bb-blue-500 font-bold mb-2"},"Filtri",-1),G={class:"flex justify-start items-center gap-4 flex-wrap"},H={class:"min-w-[225px]"},J=d("Tipologia"),ee=d("Da"),te=d("A"),oe={class:"bb-card"},ae={key:0,class:"bb-badge-warning inline-block"},ne=d(" Rimborso "),se=t("span",null,"Sei sicuro di voler rimborsare questo pagamento?",-1),le=d(" Rimborsa "),ve={__name:"Index",props:{models:Object,refundables:Number},setup(u){S(()=>N().props.value.role);const{searchQuery:m,isSearching:re,filters:l}=O("payment.index",{type:route().params.type,from:route().params.from,to:route().params.to}),p=c(!1),b=c(null),h=c(null),f=c(!1);function x(r,o){switch(r){case"download":window.open(route("payment.invoice",[o.user_id,o.id]),"_blank");break;case"refund":h.value=o,b.value.open();break}}function V(){f.value=!0,R.Inertia.post(route("payment.refund",h.value.id),{},{onSuccess:r=>{b.value.close(),f.value=!1,I.flash(r.props.flash)}})}return(r,o)=>{const M=i("bb-button"),y=i("bb-label"),B=i("bb-select"),g=i("datepicker"),C=i("BbButton"),T=i("BbDialog");return _(),A(z,{title:"Transazioni"},{default:s(()=>[t("div",$,[t("div",Q,[a(L,{modelValue:n(m),"onUpdate:modelValue":o[0]||(o[0]=e=>j(m)?m.value=e:null)},null,8,["modelValue"])]),t("div",E,[u.refundables>0?(_(),k("span",K,[a(n(F),{class:"w-6 h-6 mr-1"}),d(" "+v(u.refundables),1)])):w("",!0),t("a",{href:r.route("payment.export",{type:n(l).type,from:n(l).from,to:n(l).to})},[a(M,{type:"button"},{default:s(()=>[a(n(U),{class:"w-6 h-6"})]),_:1})],8,W)]),t("button",{class:"bb-button-style-filter",type:"button",onClick:o[1]||(o[1]=e=>p.value=!p.value)},Y)]),t("div",{class:D("bb-card mb-3 px-7 py-5 "+(p.value?"block":"hidden"))},[Z,t("div",G,[t("div",H,[a(y,{class:"text-sm mb-1"},{default:s(()=>[J]),_:1}),a(B,{mode:"single",class:"w-full",placeholder:"Seleziona un'opzione","close-on-select":!0,options:{subscription:"Abbonamento",package:"Pacchetto",charge:"Acquisto Singolo"},modelValue:n(l).type,"onUpdate:modelValue":o[2]||(o[2]=e=>n(l).type=e)},null,8,["modelValue"])]),t("div",null,[a(y,{class:"text-sm mb-1"},{default:s(()=>[ee]),_:1}),a(g,{modelValue:n(l).from,"onUpdate:modelValue":o[3]||(o[3]=e=>n(l).from=e),format:"dd/MM/yyyy",previewFormat:"dd/MM/yyyy",locale:"it-IT",modelType:"dd/MM/yyyy",enableTimePicker:!1,monthNameFormat:"long",autoApply:""},null,8,["modelValue"])]),t("div",null,[a(y,{class:"text-sm mb-1"},{default:s(()=>[te]),_:1}),a(g,{modelValue:n(l).to,"onUpdate:modelValue":o[4]||(o[4]=e=>n(l).to=e),format:"dd/MM/yyyy",previewFormat:"dd/MM/yyyy",locale:"it-IT",modelType:"dd/MM/yyyy",enableTimePicker:!1,monthNameFormat:"long",autoApply:""},null,8,["modelValue"])])])],2),t("div",oe,[a(q,{collection:u.models.data,columns:[{slot:"customer",label:"Cliente"},{computed:e=>{switch(e.subject){case"booking-create":return"Nuovo appuntamento";case"booking-edit":return"Modifica appuntamento";case"package":return"Acquisto pacchetto";case"subscription-create":return"Acquisto abbonamento";case"subscription-cycle":return"Rinnovo Abbonamento"}},label:"Oggetto"},{key:"date",label:"Data"},{key:"total",label:"Totale",format:"currency"},{computed:e=>{switch(e.method){case"stripe":return"Stripe";case"cash":return"Pagamento in contanti";case"satispay":return"Pagamento con Satispay";case"card":return"Pagamento in carta"}},label:"Metodo di pagamento"},{slot:"refunded",label:""}],links:u.models.links,actions:[{name:"download",condition:e=>e.stripe_payment_id!==null},{name:"refund",condition:e=>e.refundable}],onAction:o[5]||(o[5]=e=>x(e.action,e.item))},{customer:s(({item:e})=>[a(n(P),{href:r.route("customer.show",e.user.id),class:"underline"},{default:s(()=>[t("strong",null,v(e.user.full_name),1)]),_:2},1032,["href"])]),refunded:s(({item:e})=>[e.refunded?(_(),k("div",ae,"Rimborsato")):w("",!0)]),_:1},8,["collection","columns","links","actions"]),a(T,{ref_key:"refundDialog",ref:b,type:"plain",size:"sm"},{title:s(()=>[ne]),buttons:s(()=>[a(C,{danger:"",disabled:f.value,onClick:V},{default:s(()=>[le]),_:1},8,["disabled"])]),default:s(()=>[se]),_:1},512)])]),_:1})}}};export{ve as default};
