import{r as o,y as U,ap as K,o as k,c as y,a as i,a5 as O,b as a,w as n,U as s,q as P,a8 as u,X as Q,Y as R,I as w,S as d,K as E,L as z}from"./app.c248d67c.js";import{m as q,a as G,b as W,F as X}from"./main.fb97573b.js";const Y={class:"flex items-center justify-between mb-4 flex-wrap gap-2"},Z={class:"grid grid-cols-2 sm:flex items-center space-x-4 w-full sm:w-auto"},J=d("Salva"),ee={class:"bg-white rounded-xl overflow-hidden"},te={key:0,class:"text-bb-danger text-sm"},le=d("OK"),ne={key:0,class:"text-bb-danger text-sm"},ae=d("Elimina"),oe=d("Salva"),ie={__name:"ScheduleDefaultCalendar",props:{events:Array,businessHours:Array},setup(H){const x=o(null),b=o(null),c=o(!1);U(()=>{b.value=x.value.getApi()});const t=K({id:null,title:null,start:null,end:null,editable:!0});function A(e){t.id="new",t.title="",t.start=e.startStr,t.end=e.endStr,V(),_.value.open()}function L(e){r=e.event,t.title=e.event.title,t.start=e.event.startStr,t.end=e.event.endStr,V(),f.value.open()}function M(e){g(e.event)}function N(e){console.log(e.event),g(e.event)}const m=o(!1);function C(){return t.title?(m.value=!1,!0):(m.value=!0,!1)}function V(){m.value=!1}const _=o(null),h=o([]);function T(){if(!C())return;const e=b.value.addEvent(t);h.value.push(e),_.value.close(),p()}const f=o(null),D=o([]),F=o([]);let r=null;function j(){!C()||(r&&(r.setProp("title",t.title),g(r),p()),f.value.close())}function g(e){e.id!=="new"&&D.value.push(e.id)}function B(){r&&(F.value.push(r.id),r.remove(),p()),f.value.close()}function p(){const e=b.value.getEvents().filter(l=>l.id=="new"||D.value.includes(l.id)).map(l=>({id:l.id,workers:l.title,weekday:u(l.startStr).locale("en").format("ddd").toLowerCase(),start:u(l.startStr).format("HH:mm"),end:u(l.endStr).format("HH:mm")}));Q.Inertia.post(route("schedule.default.save"),{events:e,deleted:F.value},{preserveScroll:!0,preserveState:!0,onFinish:()=>{h.value.forEach(l=>l.remove()),h.value=[],R.flash({type:"success",message:"Programmazione salvata"})}})}return(e,l)=>{const v=w("bb-button"),I=w("bb-input"),$=w("bb-dialog");return k(),y(P,null,[i("div",null,[i("div",Y,[i("div",null,[O(e.$slots,"title")]),i("div",Z,[a(v,{onClick:p},{default:n(()=>[J]),_:1}),a(v,{onClick:l[0]||(l[0]=()=>{c.value=!c.value})},{default:n(()=>[d(E(c.value?"Slot 30":"Slot 5"),1)]),_:1})])]),i("div",ee,[a(s(X),{ref_key:"calendar",ref:x,options:{plugins:[s(q),s(G),s(W)],locale:"it",initialView:"timeGridWeek",headerToolbar:!1,dayHeaderFormat:{weekday:"short"},slotLabelInterval:c.value?"00:05:00":"00:30:00",slotLabelFormat:{hour:"numeric",minute:"2-digit",omitZeroMinute:!1,meridiem:"short"},allDaySlot:!1,selectable:!0,firstDay:1,slotDuration:c.value?"00:05:00":"00:30:00",slotMinTime:"07:00:00",slotMaxTime:"23:00:00",eventClick:L,eventResize:M,eventDrop:N,select:A,businessHours:H.businessHours,events:H.events}},null,8,["options"])])]),a($,{ref_key:"createDialog",ref:_,size:"md"},{title:n(()=>[d(" Inserisci numero di persone per lo slot "+E(`${s(u)(t.start).format("HH:mm")} - ${s(u)(t.end).format("HH:mm")}`),1)]),buttons:n(()=>[a(v,{onClick:T},{default:n(()=>[le]),_:1})]),default:n(()=>[i("div",null,[a(I,{type:"number",modelValue:t.title,"onUpdate:modelValue":l[1]||(l[1]=S=>t.title=S),placeholder:"Inserisci il numero di persone"},null,8,["modelValue"]),m.value?(k(),y("div",te," Questo campo \xE8 obbligatorio ")):z("",!0)])]),_:1},512),a($,{ref_key:"editDialog",ref:f,size:"md"},{title:n(()=>[d(" Inserisci numero di persone per lo slot "+E(`${s(u)(t.start).format("HH:mm")} - ${s(u)(t.end).format("HH:mm")}`),1)]),buttons:n(()=>[a(v,{danger:"",onClick:B},{default:n(()=>[ae]),_:1}),a(v,{onClick:j},{default:n(()=>[oe]),_:1})]),default:n(()=>[i("div",null,[a(I,{type:"number",modelValue:t.title,"onUpdate:modelValue":l[2]||(l[2]=S=>t.title=S),placeholder:"Inserisci il numero di persone"},null,8,["modelValue"]),m.value?(k(),y("div",ne," Questo campo \xE8 obbligatorio ")):z("",!0)])]),_:1},512)],64)}}};export{ie as default};
