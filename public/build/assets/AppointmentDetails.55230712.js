import{r as m,W as ce,y as de,g as C,o as s,c as l,b as i,w as d,q as J,I as h,a as e,K as c,U as r,a8 as z,e as T,L as u,J as re,Q as K,S as _,X as Q,a9 as R}from"./app.45a2e0de.js";import{_ as ue}from"./StylistLayout.c6e352be.js";import me from"./BookingStatusLight.3c62d82c.js";import be from"./ScheduleAppointmentStatusBadge.d0c04c36.js";import{B as v}from"./Table.e80badd5.js";import _e from"./BookingPaymentDialog.c21dfd47.js";import"./Logo.1cde1930.js";import"./wizardStore.ef397de9.js";import"./XIcon.52e671f8.js";import"./menu.365b37e7.js";import"./disclosure.b237ce99.js";import"./PencilIcon.9b9a523e.js";import"./RefreshIcon.76168562.js";import"./CheckIcon.b71d4ea3.js";const pe={class:"flex justify-start items-center mt-4 mb-6"},fe={class:"bb-card p-8 mb-8"},he={class:"flex flex-wrap items-center justify-between gap-4 mb-4"},ge={class:"flex items-center space-x-4"},ye={class:"text-bb-blue-500 big-header-title"},ke={class:"flex items-center space-x-4"},ve=_("Cancella"),xe=_("Modifica"),we={class:"bb-tab-bar"},Se=["onClick"],De={key:0},Pe={class:"space-y-3 mb-8"},Be=e("h2",{class:"text-xl font-medium text-bb-primary"},"Informazioni",-1),Ae={class:"flex items-center"},Ce=e("div",{class:"uppercase text-bb-gray-700 w-36 text-xs pt-[5px]"}," Cliente ",-1),ze={class:"flex-1 flex items-center space-x-2"},Te=["src"],Ve=["href"],je={key:1},$e={class:"flex items-center"},Ie=e("div",{class:"uppercase text-bb-gray-700 w-36 text-xs pt-[5px]"}," Orario ",-1),Me={class:"flex-1"},Ne={key:0,class:"flex items-center"},Ye=e("div",{class:"uppercase text-bb-gray-700 w-36 text-xs pt-[5px]"}," Stylist ",-1),Ee={class:"flex-1"},Oe={class:"flex items-center"},Ue=e("div",{class:"uppercase text-bb-gray-700 w-36 text-xs"},"Status",-1),Fe={class:"flex-1"},He={class:"flex items-center"},qe=e("div",{class:"uppercase text-bb-gray-700 w-36 text-xs"},"Applicato",-1),Le={class:"flex-1"},Je={key:0},Ke={key:1},Qe={key:2},Re={key:3},We={class:"space-y-3 mb-8"},Xe=e("h2",{class:"text-xl font-medium text-bb-primary"},"Servizi prenotati",-1),Ge={class:"flex justify-end space-x-12"},Ze={class:"flex items-center space-x-3"},et=e("div",{class:"uppercase"},"totale",-1),tt={key:0,class:"line-through text-bb-gray-500"},ot={class:"font-bold text-bb-blue-600"},st={class:"flex items-center space-x-3"},at=e("div",{class:"uppercase"},"pagato",-1),nt={class:"space-y-3 mb-8"},it=e("h2",{class:"text-xl font-medium text-bb-primary"},"Transazioni",-1),lt={class:"space-y-3 mb-8"},ct=e("h2",{class:"text-xl font-medium text-bb-primary"},"Rimborsi",-1),dt={key:1},rt={class:"flex items-center justify-between"},ut=e("h2",{class:"text-xl font-medium text-bb-primary"}," Pagamenti in store ",-1),mt=_("Aggiungi"),bt={key:2},_t=_(" Elimina appuntamento "),pt=e("span",null,"Una volta eliminato, non potrai pi\xF9 recuperare le informazioni.",-1),ft=_(" Elimina "),ht=_(" Elimina pagamento "),gt=e("span",null,"Una volta eliminato, non potrai pi\xF9 recuperare le informazioni.",-1),yt=_(" Elimina "),It={__name:"AppointmentDetails",props:{booking:Object,payments:Array,storePayments:Array,refunds:Array},setup(t){const b=t,V=m(ce().props.value.role);function p(){return helpers.lg(V.value===helpers.role_admin),V.value===helpers.role_admin}const x=m(null),j=m([]);de(()=>{x.value=b.booking.stylist_id,p()&&W()});function W(){axios.get(route("booking.stylists",b.booking.id)).then(o=>{helpers.lg(o.data),j.value=o.data})}function X(o){Q.Inertia.post(route("booking.update.stylist",b.booking.id),{stylist_id:o},{onSuccess:a=>{helpers.flash(a.props.flash)}})}const f=m("info"),G=[{key:"info",title:"Info"},{key:"store-payments",title:"Pagamenti in store"},{key:"form",title:"Scheda"}],w=C(()=>{var o;return(o=b.booking.additional_data)==null?void 0:o.subscription}),S=C(()=>{var o,a;return(a=(o=b.booking.additional_data)==null?void 0:o.packages)!=null?a:[]}),D=C(()=>{var o;return(o=b.booking.additional_data)==null?void 0:o.discount}),P=m(null),B=m(!1),g=m(null);function Z(){B.value=!0}function ee({action:o,item:a}){switch(o){case"delete":g.value=R(a),P.value.open();break}}function te(){g.value.delete(route("payment.destroy",g.value.id),{onSuccess:()=>{P.value.close()}})}const y=m(null),$=m(null);function oe(){y.value=R(b.booking),$.value.open()}function se(){y.value.transform(o=>({...o,redirect_to:"schedule.appointment.index"})).delete(route("booking.destroy",y.value.id))}function ae({action:o,item:a}){switch(o){case"download":console.log(a);break}}function ne(o){Q.Inertia.visit(route(o,b.booking.id))}return(o,a)=>{const ie=h("bb-back-link"),A=h("bb-button"),le=h("BbSelect"),I=h("BbButton"),M=h("BbDialog");return s(),l(J,null,[i(ue,{title:"Booking show","show-title":!1},{default:d(()=>{var k,N,Y,E,O,U,F,H,q,L;return[e("div",pe,[i(ie)]),e("div",fe,[e("div",he,[e("div",ge,[e("h1",ye," Appuntamento di "+c((k=t.booking.customer)==null?void 0:k.name)+" del "+c(r(z)(t.booking.date).format("DD/MM/YYYY")),1),i(me,{status:t.booking.status},null,8,["status"])]),e("div",ke,[p()?(s(),T(A,{key:0,light:"",onClick:oe},{default:d(()=>[ve]),_:1})):u("",!0),p()?(s(),T(A,{key:1,onClick:a[0]||(a[0]=n=>ne("booking.edit"))},{default:d(()=>[xe]),_:1})):u("",!0)])]),e("div",we,[(s(),l(J,null,re(G,n=>e("button",{key:n.key,class:K(["bb-tab-bar__button",{"bb-tab-bar__button--active":n.key==f.value}]),onClick:kt=>f.value=n.key},c(n.title),11,Se)),64))]),f.value=="info"?(s(),l("div",De,[e("div",Pe,[Be,e("div",Ae,[Ce,e("div",ze,[e("img",{src:(N=t.booking.customer)==null?void 0:N.profile_photo_url,class:"block rounded-full w-8 h-8 object-cover object-center"},null,8,Te),e("div",null,[p()?(s(),l("a",{key:0,class:"underline",href:o.route("customer.show",t.booking.customer)},c((Y=t.booking.customer)==null?void 0:Y.full_name),9,Ve)):(s(),l("p",je,c((E=t.booking.customer)==null?void 0:E.full_name),1))])])]),e("div",$e,[Ie,e("div",Me,c(r(z)(`2000-01-01 ${t.booking.start}`).format("HH:mm"))+" - "+c(r(z)(`2000-01-01 ${t.booking.start}`).add(t.booking.total_execution_time,"minutes").format("HH:mm")),1)]),p()?(s(),l("div",Ne,[Ye,e("div",Ee,[i(le,{mode:"single",placeholder:"Seleziona lo stylist","close-on-select":!0,options:j.value,modelValue:x.value,"onUpdate:modelValue":a[1]||(a[1]=n=>x.value=n),onChange:X},null,8,["options","modelValue"])])])):u("",!0),e("div",Oe,[Ue,e("div",Fe,[i(be,{status:t.booking.status},null,8,["status"])])]),e("div",He,[qe,e("div",Le,[!r(w)&&!((O=r(S))!=null&&O.length)&&!r(D)?(s(),l("span",Je," Nessuno sconto applicato ")):u("",!0),r(w)?(s(),l("span",Ke,"Abbonamento "+c(r(w).name),1)):u("",!0),(U=r(S))!=null&&U.length?(s(),l("span",Qe,", "+c(r(S).map(n=>`Pacchetto ${n.name}`).join(", ")),1)):u("",!0),r(D)?(s(),l("span",Re,", Codice sconto "+c(r(D).code),1)):u("",!0)])])]),e("div",We,[Xe,i(v,{collection:t.booking.slots,columns:[{key:"service.title",label:"Servizio",classes:"font-bold"},{key:"service.net_price",label:"Prezzo IVA inclusa",format:"currency"},{computed:()=>null,label:"",classes:"w-full"}]},null,8,["collection","columns"])]),e("div",Ge,[e("div",Ze,[et,((F=t.booking.additional_data)==null?void 0:F.original_net_price)>((H=t.booking.additional_data)==null?void 0:H.actual_net_price)?(s(),l("div",tt,c((q=t.booking.additional_data)==null?void 0:q.original_net_price)+"\u20AC ",1)):u("",!0),e("div",ot,c((L=t.booking.additional_data)==null?void 0:L.actual_net_price)+"\u20AC ",1)]),e("div",st,[at,e("div",{class:K(["font-bold",{"text-bb-blue-600":t.booking.amount_to_pay<=0,"text-bb-danger":t.booking.amount_to_pay>0}])},c(t.booking.paid_amount)+" \u20AC ",3)])]),e("div",nt,[it,i(v,{collection:t.payments,columns:[{key:"date",label:"Data",format:"date:Y-m-d"},{computed:n=>{switch(n.subject){case"booking-create":return"Nuovo appuntamento";case"booking-edit":return"Modifica appuntamento";case"package":return"Acquisto pacchetto";case"subscription":return"Acquisto abbonamento"}},label:"Oggetto"},{computed:n=>{switch(n.method){case"stripe":return"Stripe";case"cash":return"Pagamento in contanti";case"satispay":return"Pagamento con Satispay";case"card":return"Pagamento in carta"}},label:"Metodo di pagamento"},{key:"total",label:"Totale",format:"currency"}],actions:["download"],onAction:ae},null,8,["collection","columns"])]),e("div",lt,[ct,i(v,{collection:t.refunds,columns:[{key:"created_at",label:"Data",format:"date"},{key:"total",label:"Totale",format:"currency"}]},null,8,["collection"])])])):u("",!0),f.value=="store-payments"?(s(),l("div",dt,[e("div",rt,[ut,p()?(s(),T(A,{key:0,onClick:Z},{default:d(()=>[mt]),_:1})):u("",!0)]),i(v,{collection:t.storePayments,columns:[{key:"date",label:"Data",format:"date:Y-m-d"},{computed:n=>{switch(n.method){case"stripe":return"Stripe";case"cash":return"Pagamento in contanti";case"satispay":return"Pagamento con Satispay";case"card":return"Pagamento in carta"}},label:"Metodo di pagamento"},{key:"total",label:"Totale",format:"currency"}],actions:["delete"],onAction:ee},null,8,["collection","columns"])])):u("",!0),f.value=="form"?(s(),l("div",bt,"TODO")):u("",!0)])]}),_:1}),i(M,{ref_key:"deleteDialog",ref:$,type:"plain",size:"sm"},{title:d(()=>[_t]),buttons:d(()=>[i(I,{danger:"",disabled:y.value.processing,onClick:se},{default:d(()=>[ft]),_:1},8,["disabled"])]),default:d(()=>[pt]),_:1},512),i(M,{ref_key:"storePaymentDeleteDialog",ref:P,type:"plain",size:"sm"},{title:d(()=>[ht]),buttons:d(()=>[i(I,{danger:"",disabled:g.value.processing,onClick:te},{default:d(()=>[yt]),_:1},8,["disabled"])]),default:d(()=>[gt]),_:1},512),i(_e,{"booking-id":t.booking.id,modelValue:B.value,"onUpdate:modelValue":a[2]||(a[2]=k=>B.value=k)},null,8,["booking-id","modelValue"])],64)}}};export{It as default};
