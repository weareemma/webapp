import{ai as O,V as R,W as B,g as k,r as U,ar as W,y as Y,al as q,o as D,c as J,a as m,b as u,w as c,U as n,Q as E,e as C,L as A,X as T,Y as w,a4 as K,K as X,p as $,a8 as Z}from"./app.45a2e0de.js";import{L as ee}from"./Logo.1cde1930.js";import{_ as te}from"./Wizard.1a9a6272.js";import ae from"./StepStore.5c2bb021.js";import se from"./StepPeople.dd8124e5.js";import oe from"./StepPrimaryHairService.4f248787.js";import ie from"./StepUpdo.8d3d0635.js";import le from"./StepAddons.10d016c0.js";import re from"./StepCalendar.63925efa.js";import ne from"./StepCheckout.0a380ea2.js";import{u as de}from"./wizardStore.ef397de9.js";import ue from"./DesktopNavBar.0785f1e3.js";import ce from"./MobileNavBar.1f844efb.js";import me from"./DesktopSideBar.2b2012e7.js";import pe from"./MobileSlideOver.739ed707.js";import{F as _e}from"./Footer.edc70d2c.js";import"./Checkbox.b9165bc2.js";import"./PeopleCountInput.abf6f642.js";import"./ClockIcon.85a24063.js";import"./VueTimepikcer.esm.048f18c4.js";import"./CheckoutCharge.2953de59.js";import"./ArrowLeftIcon.daf4bcb5.js";import"./PencilIcon.a5369bd7.js";const ve={class:"bg-white h-screen overflow-y-auto"},fe={class:"relative hidden md:block py-12 bg-[#F7BC74]"},ge={class:"absolute w-full h-full top-0"},be=m("div",{class:"cursor-pointer max-w-5xl flex relative mx-auto w-full h-full px-8 z-20 overflow-hidden"},[m("img",{class:"absolute -bottom-16",src:"/img/girl.png"})],-1),he={id:"wizard-container",class:"max-w-7xl mx-auto py-5 px-8"},ye={class:"text-2xl font-bold text-center text-bb-gray-900"},Se={class:"col-auto"},Ye={__name:"Wizard",props:{stores_list_wizard:Object,originalBooking:{type:Object,default:null},primaryHairServices:{type:Array,default:null},addonHairServices:{type:Object,default:null},jumpToStep:{type:String,default:null}},setup(F){const b=F;O(()=>{j()});const x=de(),{activeStep:f,isStepCheckout:I,wizardSelection:t,wizardGeneral:a,people:p,wizardLoadBooking:ke,ready:we,totalReady:h,wizardFetchData:xe}=R(x),L=B().props.value.primaries_not_included,M=k(()=>B().props.value.flash.restore_state),N=k(()=>B().props.value.subscribed),v=U(null);W(()=>{a.value.subscribed=N.value}),Y(()=>{j(),a.value.stores=b.stores_list_wizard,a.value.subscribed=N.value,console.log(a.subscribed+" test"),b.originalBooking&&x.wizardLoadBooking(b.originalBooking),P(),b.jumpToStep&&v.value.goToStepByName(b.jumpToStep),M.value&&z()});function j(){x.$reset()}function G({update:s}){h.value=!1,T.Inertia.post(route("booking.infos"),{...t.value,...a.value,people:p.value},{preserveScroll:!0,preserveState:!0,onSuccess:o=>{a.value.booking_infos={...a.value.booking_infos,...o.props.flash.data},f.value.name==="step_calendar"&&T.Inertia.post(route("booking.hair-services.check-availability"),{...a.value,...t.value,people:p.value},{preserveScroll:!0,preserveState:!0,onSuccess:e=>{const{days:i,infos:l}=e.props.flash.data;if(a.value.booking_infos={...a.value.booking_infos,...l},t.value.available_days=i,console.log(e),t.value.selected_day){const d=t.value.available_days.find(r=>r.date===t.value.selected_day.date&&r.available);if(t.value.selected_day=d!=null?d:null,t.value.selected_slot&&d){const r=d.slots.find(g=>g.time===t.value.selected_slot.time&&g.available);w.lg(r),t.value.selected_slot=r!=null?r:null}else t.value.selected_slot=null}else t.value.selected_day=null,t.value.selected_slot=null;if(t.value.selected_day===null){let d=t.value.available_days.find(r=>r.available);if(d){w.lg("SET DAY 2"),t.value.selected_day=d;let r=t.value.selected_day.slots.find(g=>g.available);r&&(t.value.selected_slot=r)}}s()},onError:e=>{console.log(e)},onFinish:()=>{h.value=!0}}),f.value.name==="step_checkout"&&(a.value.discount_code?T.Inertia.post(route("booking.discount.check"),{...a.value,...t.value,people:p.value},{preserveScroll:!0,preserveState:!0,onSuccess:e=>{var r,g;const i=(r=e.props.flash)==null?void 0:r.data,l=i==null?void 0:i.discount,d=(g=i==null?void 0:i.errors)!=null?g:[];a.value.discount=l,a.value.discount_errors=d,a.value.booking_infos.discount=l,l&&(a.value.booking_infos.actual_net_price=l.discounted_price,s())},onFinish:()=>{h.value=!0}}):h.value=!0),s()},onFinish:()=>{f.value.name!=="step_calendar"&&f.value.name!=="step_checkout"&&(h.value=!0)}})}async function P(){const s=await q.get(route("booking.payment-infos"));s.data&&(a.value.payment_infos=s.data)}async function z(){let s=JSON.parse(localStorage.getItem("wizardData"));v.value.updateData(s),await P(),v.value.goToStepByName("step_checkout"),localStorage.removeItem("wizardData")}const Q=k(()=>{let s=[{name:"step_store",title:"Dove vuoi prenotare?"},{name:"step_people",title:"Per chi vuoi prenotare?"},{name:"step_primary_hair_service",title:"Quale servizio?"},{name:"step_updo",title:"Vuoi aggiungere un raccolto?"},{name:"step_addons",title:"Quali add-on?"}];return s=s.concat([{name:"step_calendar",title:"Quando vuoi venire?",onBeforeShow:()=>t.value.store_id,onShow:()=>{t.value.available_days=null}},{name:"step_checkout",title:b.originalBooking?"Conferma le modifiche":"Procedi all\u2019acquisto per concludere la prenotazione",onBeforeShow:()=>!!(t.value.store_id&&t.value.selected_day&&t.value.selected_slot)}]),s}),y=k(()=>{let s=[{title:"Dove",wizardStep:"step_store"},{title:"Numero persone",wizardStep:"step_people"},{title:"Servizi",wizardStep:"step_primary_hair_service"},{title:"Raccolti",wizardStep:"step_updo"},{title:"Add-on",wizardStep:"step_addons"}];return s=s.concat([{title:"Quando",wizardStep:"step_calendar"},{title:"Checkout",wizardStep:"step_checkout"}]),s});function S(s){var o,e;switch(s){case"step_store":if(t.value.store_id){let i=a.value.stores.find(l=>l.id===t.value.store_id);return i?i.name:"-"}return null;case"step_primary_hair_service":return"-";case"step_people":return t.value.multiple&&p.value.length>0?p.value.length+" persone":"Solo tu";case"step_updo":return"-";case"step_addons":return"-";case"step_calendar":return t.value.selected_day,t.value.selected_slot?Z(`${(o=t.value.selected_day)==null?void 0:o.date} ${(e=t.value.selected_slot)==null?void 0:e.time}`).format("ddd DD MMMM, HH:mm"):"-"}}$("getMenuItemData",S);function V(s){return"temp"}$("getPriceItemData",V);function H(s){let o=[];switch(s){case"step_store":return[{title:"",data:[{title:S(s)}]}];case"step_people":return[{title:"",data:[{title:S(s)}]}];case"step_primary_hair_service":return _.forEach(p.value,e=>{var i,l;o.push({title:e.name===0?"Tu":"Amica "+e.name,data:[{title:e.primary_service?e.primary_service.title+"("+e.primary_service.execution_time_fe+"')":null,price:e.primary_service?(i=e.primary_service)==null?void 0:i.net_price:null,discounted:e.name===0&&a.value.subscribed&&!L.includes((l=e.primary_service)==null?void 0:l.title)}]})}),o;case"step_updo":return _.forEach(p.value,e=>{o.push({title:e.name===0?"Tu":"Amica "+e.name,data:[{title:e.addons.updo.length>0?e.addons.updo[0].title+"("+(e.addons.updo[0].extra===!0?0:e.addons.updo[0].execution_time_fe)+"')":null,price:e.addons.updo.length>0?e.addons.updo[0].net_price:null,discounted:e.name===0&&a.value.subscribed,discountedPrice:e.name===0&&a.value.subscribed&&e.addons.updo.length>0?e.addons.updo[0].net_price_discounted:null}]})}),o;case"step_addons":return _.forEach(p.value,e=>{let i=[],l=[],d=[];e.addons.massage.length>0&&(i.push(e.addons.massage[0].title+"("+(e.addons.massage[0].extra===!0?0:e.addons.massage[0].execution_time_fe)+"')"),l.push(e.addons.massage[0].net_price),d.push(w.printPrice(e.addons.massage[0].net_price_discounted))),e.addons.treatment.length>0&&(i.push(e.addons.treatment[0].title+"("+(e.addons.treatment[0].extra===!0?0:e.addons.treatment[0].execution_time_fe)+"')"),l.push(e.addons.treatment[0].net_price),d.push(w.printPrice(e.addons.treatment[0].net_price_discounted))),o.push({title:e.name===0?"Tu":"Amica "+e.name,data:[{title:i.join(", "),price:l.join("\u20AC "),discounted:e.name===0&&a.value.subscribed,discountedPrice:e.name===0&&a.value.subscribed?d.join("\u20AC "):null}]})}),o;case"step_calendar":return[{title:"",data:[{title:S(s)}]}];default:return[]}}return $("getSidebarData",H),(s,o)=>(D(),J("div",ve,[m("div",fe,[u(ee,{class:"w-full flex items-center justify-center z-20",light:!1}),m("div",ge,[u(n(K),{href:"/"},{default:c(()=>[be]),_:1})])]),u(ue,{onGoTo:o[0]||(o[0]=e=>v.value.goToStepByName(e)),"disable-edit":n(a).disableEdit,"menu-items":n(y)},null,8,["disable-edit","menu-items"]),m("div",he,[u(ce,{onGoTo:o[1]||(o[1]=e=>v.value.goToStepByName(e)),"disable-edit":n(a).disableEdit,"menu-items":n(y)},null,8,["disable-edit","menu-items"]),m("div",{class:E(["grid md:gap-6 col-end md:col-start",{"grid-cols-1 md:grid-cols-2 lg:grid-cols-3":!n(I),"grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3":n(I)}])},[m("div",{class:E(["col-span-3 sm:px-8",n(f).name!=="step_checkout"?"md:col-span-1 lg:col-span-2":""])},[u(te,{ref_key:"wizard",ref:v,steps:n(Q),showCallback:G,onLoggedIn:z,onRegistered:z},{title:c(({title:e})=>[m("p",ye,X(e),1)]),step_store:c(()=>[u(ae)]),step_people:c(()=>[u(se)]),step_primary_hair_service:c(()=>[u(oe)]),step_updo:c(()=>[u(ie)]),step_addons:c(()=>[u(le)]),step_calendar:c(()=>[u(re)]),step_checkout:c(()=>[u(ne)]),_:1},8,["steps"])],2),m("div",Se,[n(f).name!=="step_checkout"?(D(),C(me,{key:0,onGoTo:o[2]||(o[2]=e=>v.value.goToStepByName(e)),"disable-edit":n(a).disableEdit,"menu-items":n(y)},null,8,["disable-edit","menu-items"])):A("",!0)])],2)]),n(f).name!=="step_checkout"?(D(),C(pe,{key:0,onGoTo:o[3]||(o[3]=e=>v.value.goToStepByName(e)),"disable-edit":n(a).disableEdit,"menu-items":n(y)},null,8,["disable-edit","menu-items"])):A("",!0),u(_e,{class:"mt-10"})]))}};export{Ye as default};
