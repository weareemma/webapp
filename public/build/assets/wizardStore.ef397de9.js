import{a7 as g,r as d,g as h,a8 as q}from"./app.45a2e0de.js";const K=g("wizard",()=>{const w=d({value:0,name:"step_store",next:"step_people"}),m=d(!0),H=d(!0),l=d({customers:[],original_booking:null,editing_id:null,disable_edit:!1,stores:[],primaries:[],payment_infos:null,invalid_discount_code:null,discount_errors:null,discount_code:null,discount:null,booking_infos:null,stylist:null,with_refund:!1,subscribed:!1,alreadyPaid:0,order:null}),t=d({customer_id:null,stylist:!1,store_id:null,washing_stations:0,multiple:!1,different_services:!1,selected_day:null,selected_slot:null,available_days:null}),u=()=>({name:0,primary_service:null,addons:{updo:[],massage:[],treatment:[]},services_selection:[],total_time:0,total_price:0}),i=d([u()]),I=h(()=>({step_store:!0,step_customer:!0,step_people:!!t.value.store_id&&!!t.value.store_id,step_primary_hair_service:!!t.value.store_id&&!!t.value.store_id,step_updo:!!t.value.store_id&&!!t.value.store_id&&n(),step_addons:!!t.value.store_id&&!!t.value.store_id&&n(),step_calendar:!!t.value.store_id&&!!t.value.store_id&&n(),step_checkout:!!t.value.store_id&&!!t.value.store_id&&n()&&!!t.value.selected_day&&!!t.value.selected_slot})),j=d(!1),B=h(()=>w.value.name==="step_checkout"),D=h(()=>l.value.stylist),G=d(!1),L=function(e){var s,a,o,c,P,S,x,R,E;if(e){l.value.original_booking=e,l.value.editing_id=e.id,l.value.disable_edit=e.customer_must_pay,l.value.booking_infos=e.additional_data,l.value.discount=(s=e.additional_data)==null?void 0:s.discount,l.value.discount_code=(o=(a=e.additional_data)==null?void 0:a.discount)==null?void 0:o.code,l.value.stylist=(c=e.stylist)!=null?c:null,l.value.alreadyPaid=(x=(S=(P=e.order)==null?void 0:P.paid)!=null?S:e.paid_amount)!=null?x:0,l.value.order=e.order,t.value.customer_id=e.customer_id,t.value.store_id=e.store_id,t.value.multiple=e.multiple,t.value.different_services=e.different_services,t.value.selected_day={date:e.date},t.value.selected_slot={time:q(`2000-01-01 ${e.start}`).format("HH:mm")},z(!0);let _=u();_.name=0,_.primary_service=(R=e.slots[0].service)!=null?R:null;for(let r=1;r<((E=e.slots)==null?void 0:E.length);r++){const v=e.slots[r];v.service.type&&_.addons[v.service.type].push(v.service)}i.value.push(_),e.multiple&&e.get_children.forEach((r,v)=>{var A,C;let p=u();p.name=r.guest,p.primary_service=(A=r.slots[0].service)!=null?A:null;for(let y=1;y<((C=r.slots)==null?void 0:C.length);y++){const F=r.slots[y];p.addons[F.service.type].push(F.service)}i.value.push(p)}),f("step_store"),i.value.forEach(r=>{f("step_primary_hair_service",{primaryId:r.primary_service.id,name:r.name})})}},z=function(e=!1){i.value=[],e||i.value.push(u())},V=function(e){let s=i.value.find(a=>a.name===e);s&&(s.addons={updo:[],massage:[],treatment:[]})},W=function(e){let s=i.value.find(a=>a.name===e);s&&(s.primary_service=null)},$=function(e){for(let s=1;s<=e;s++){let a=u();a.name=s,i.value.push(a)}},n=function(){return!i.value.find(s=>s.primary_service===null)},f=async function(e,s=null){switch(m.value=!1,e){case"step_store":await axios.post(route("booking.hair-services.primary")).then(a=>{l.value.primaries=a.data.data});break;case"step_customer":await axios.post(route("booking.customer.subscribed"),{customer:t.value.customer_id}).then(a=>{l.value.subscribed=a.data.data});break;case"step_primary_hair_service":await axios.post(route("booking.hair-services.addon",s.primaryId)).then(a=>{let o=i.value.find(c=>c.name===s.name);o&&(o.services_selection=a.data.data)});break}m.value=!0};return{ready:m,totalReady:H,activeStep:w,disableEdit:j,isStepCheckout:B,wizardSelection:t,isValid:I,isStylist:D,loading:G,people:i,wizardGeneral:l,wizardResetPeople:z,wizardResetPrimary:W,wizardLoadBooking:L,wizardAddPeople:$,wizardResetAddons:V,wizardFetchData:f}});export{K as u};
