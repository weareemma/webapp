import{_ as O}from"./StylistLayout.c6e352be.js";import{V as E,r as S,y as L,Y as h,al as N,g as w,o as H,e as V,w as n,a as v,b as l,U as y,aL as Q,K as W,S as q,X as x,p as z,I as G,a8 as R}from"./app.45a2e0de.js";import{_ as Y}from"./Wizard.1a9a6272.js";import F from"./StepCustomer.bc84f7de.js";import K from"./StepPeople.dd8124e5.js";import U from"./StepPrimaryHairService.4f248787.js";import X from"./StepUpdo.8d3d0635.js";import J from"./StepAddons.10d016c0.js";import Z from"./StepCalendar.63925efa.js";import ee from"./StepCheckout.0a380ea2.js";import te from"./StepSuccess.65a7a5a6.js";import ae from"./AdminBookingSidebar.e502e969.js";import{u as se}from"./wizardStore.ef397de9.js";import"./Logo.1cde1930.js";import"./XIcon.52e671f8.js";import"./menu.365b37e7.js";import"./disclosure.b237ce99.js";import"./Checkbox.b9165bc2.js";import"./PeopleCountInput.abf6f642.js";import"./ClockIcon.85a24063.js";import"./VueTimepikcer.esm.048f18c4.js";import"./CheckoutCharge.2953de59.js";import"./PencilIcon.a5369bd7.js";const ie={class:"mx-auto max-w-7xl sm:px-6 lg:px-8 sm:mt-10"},oe={class:"mx-auto"},re=q(" Torna indietro "),le={class:"flex flex-wrap gap-6 mt-6"},ne={class:"flex-1",id:"wizard_div"},Oe={__name:"Edit",props:{stores_list_wizard:Object,customers:Object,originalBooking:{type:Object,default:null},primaryHairServices:{type:Array,default:null},addonHairServices:{type:Object,default:null}},setup(A){const u=A,g=se(),{activeStep:B,isStepCheckout:ue,wizardSelection:t,wizardGeneral:i,people:d,wizardLoadBooking:ce,ready:de,wizardFetchData:_e}=E(g),k=S(null),b=S(!1);L(()=>{h.lg(u),$(),i.value.stores=u.stores_list_wizard,u.originalBooking?g.wizardLoadBooking(u.originalBooking):t.value.store_id=u.store_id,i.value.customers=u.customers,console.log(t.value.store_id),console.log(i.value.stores),T()});function $(){g.$reset()}function D(){b.value=!0}async function T(){const a=await N.get(route("booking.payment-infos"));a.data&&(i.value.payment_infos=a.data)}function M({update:a}){x.Inertia.post(route("booking.infos"),{...t.value,...i.value,people:d.value},{preserveScroll:!0,preserveState:!0,onSuccess:s=>{i.value.booking_infos={...i.value.booking_infos,...s.props.flash.data},B.value.name==="step_calendar"&&x.Inertia.post(route("booking.hair-services.check-availability"),{...i.value,...t.value,people:d.value},{preserveScroll:!0,preserveState:!0,onSuccess:e=>{const{days:o,infos:m}=e.props.flash.data;if(i.value.booking_infos={...i.value.booking_infos,...m},t.value.available_days=o,t.value.selected_day){const c=t.value.available_days.find(r=>r.date===t.value.selected_day.date&&r.available);if(t.value.selected_day=c!=null?c:null,t.value.selected_slot&&c){const r=c.slots.find(f=>f.time===t.value.selected_slot.time&&f.available);h.lg(r),t.value.selected_slot=r!=null?r:null}else t.value.selected_slot=null}else t.value.selected_day=null,t.value.selected_slot=null;if(t.value.selected_day===null){let c=t.value.available_days.find(r=>r.available);if(c){h.lg("SET DAY 2"),t.value.selected_day=c;let r=t.value.selected_day.slots.find(f=>f.available);r&&(t.value.selected_slot=r)}}a()}}),a()}})}const j=w(()=>{let a=[{name:"step_customer",title:"Scegli il cliente"},{name:"step_people",title:"Per chi vuoi prenotare?"},{name:"step_primary_hair_service",title:"Quale servizio vuoi prenotare?"},{name:"step_updo",title:"Quali raccolti vuoi aggiungere?"},{name:"step_addons",title:"Quali add-on vuoi aggiungere?"}];return a=a.concat([{name:"step_checkout",title:u.originalBooking?"Conferma le modifiche":"Procedi all\u2019acquisto per concludere la prenotazione",onBeforeShow:()=>!!(t.value.store_id&&t.value.selected_day&&t.value.selected_slot)},{name:"step_success",title:"Acquisto effettuato!"}]),a}),C=w(()=>{let a=[{title:"Chi",wizardStep:"step_customer"},{title:"Numero persone",wizardStep:"step_people"},{title:"Servizi",wizardStep:"step_primary_hair_service"},{title:"Raccolti",wizardStep:"step_updo"},{title:"Add-on",wizardStep:"step_addons"}];return a=a.concat([{title:"Orario",wizardStep:"step_calendar"},{title:"Checkout",wizardStep:"step_checkout"}]),a});function p(a){var s,e;switch(a){case"step_customer":return i.value.customer_id?u.customers[i.value.customer_id]:"-";case"step_primary_hair_service":return"-";case"step_people":return t.value.multiple&&d.value.length>0?d.value.length+" persone":"Solo tu";case"step_updo":return"-";case"step_addons":return"-";case"step_calendar":return t.value.selected_day,t.value.selected_slot?R(`${(s=t.value.selected_day)==null?void 0:s.date} ${(e=t.value.selected_slot)==null?void 0:e.time}`).format("ddd DD MMMM, HH:mm"):"-"}}z("getMenuItemData",p);function I(a){let s=[];switch(a){case"step_customer":return[{title:"",data:[{title:p(a)}]}];case"step_store":return[{title:"",data:[{title:p(a)}]}];case"step_people":return[{title:"",data:[{title:p(a)}]}];case"step_primary_hair_service":return _.forEach(d.value,e=>{var o;s.push({title:e.name===0?"Tu":"Amica "+e.name,data:[{title:e.primary_service?e.primary_service.title+"("+e.primary_service.execution_time_fe+"')":null,price:e.primary_service?(o=e.primary_service)==null?void 0:o.net_price:null}]})}),s;case"step_updo":return _.forEach(d.value,e=>{s.push({title:e.name===0?"Tu":"Amica "+e.name,data:[{title:e.addons.updo.length>0?e.addons.updo[0].title+"("+e.addons.updo[0].execution_time_fe+"')":null,price:e.addons.updo.length>0?e.addons.updo[0].net_price:null}]})}),s;case"step_addons":return _.forEach(d.value,e=>{let o=[],m=[];e.addons.massage.length>0&&(o.push(e.addons.massage[0].title+"("+e.addons.massage[0].execution_time_fe+"')"),m.push(e.addons.massage[0].net_price)),e.addons.treatment.length>0&&(o.push(e.addons.treatment[0].title+"("+e.addons.treatment[0].execution_time_fe+"')"),m.push(e.addons.treatment[0].net_price)),s.push({title:e.name===0?"Tu":"Amica "+e.name,data:[{title:o.join(", "),price:m.join("\u20AC, ")}]})}),s;case"step_calendar":return[{title:"",data:[{title:p(a)}]}];default:return[]}}z("getSidebarData",I);function P(a){k.value.goToStepByName(a),(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))&&window.scrollTo({top:1e5,left:0,behavior:"smooth"})}return(a,s)=>{const e=G("bb-link");return H(),V(O,{title:"Modifica"},{default:n(()=>[v("div",ie,[v("div",oe,[l(e,{href:a.route("stylist.booking.details",u.originalBooking.id)},{default:n(()=>[l(y(Q),{class:"h-4"}),re]),_:1},8,["href"]),v("div",le,[l(ae,{onGoTo:s[0]||(s[0]=o=>P(o)),"menu-items":y(C)},null,8,["menu-items"]),v("div",ne,[l(Y,{ref_key:"wizard",ref:k,steps:y(j),showCallback:M,onLinkSent:D,class:"w-full px-6"},{title:n(({title:o})=>[v("h2",null,W(o),1)]),step_customer:n(()=>[l(F)]),step_people:n(()=>[l(K)]),step_primary_hair_service:n(()=>[l(U)]),step_updo:n(()=>[l(X)]),step_addons:n(()=>[l(J)]),step_calendar:n(()=>[l(Z)]),step_checkout:n(()=>[l(ee,{"no-stripe":!0})]),step_success:n(()=>[l(te,{"payment-link-sent":b.value},null,8,["payment-link-sent"])]),_:1},8,["steps"])])])])])]),_:1})}}};export{Oe as default};
